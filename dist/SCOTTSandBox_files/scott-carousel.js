var scott=scott||{};scott.carousel=scott.carousel||new function(){var player;var startVideoBt;this.init=function(){scott.tools.maxHeight('.carousel-caption');positionCarouselMenu();jQuery('.carousel').each(function(){jQuery(this).carousel({interval:5000});});jQuery(window).resize(function(){scott.tools.maxHeight('.carousel-caption');positionCarouselMenu();});jQuery(".btPlay").fancybox({fitToView:false,width:'100%',height:'100%',padding:0,margin:0,closeClick:false,openEffect:'elastic',openSpeed:250,closeEffect:'elastic',closeSpeed:250,afterLoad:function(){var id=jQuery(".fancybox-inner").find('iframe').attr('id');player=new YT.Player(id,{events:{'onStateChange':onStateChange}});},beforeClose:function(){if(player.getPlayerState()!=YT.PlayerState.ENDED){var _href=startVideoBt.attr("href");startVideoBt.attr('href',_href.replace(/start=[^&]+/,'start='+Math.round(player.getCurrentTime())));startVideoBt.html('<span class="icon-play4"/>'+jQuery("#watch_continue").val());}else{var _href=startVideoBt.attr("href");startVideoBt.attr('href',_href.replace(/start=[^&]+/,'start=0'));startVideoBt.html('<span class="icon-play4"/>'+jQuery("#watch_again").val());}},afterClose:function(){jQuery(".carousel").carousel('cycle');},});jQuery(".btPlay").on('click touchend',function(e){jQuery(".carousel").carousel('pause');startVideoBt=jQuery(this);});jQuery('.carousel').swiperight(function(){jQuery(this).carousel('prev');});jQuery('.carousel').swipeleft(function(){jQuery(this).carousel('next');});}
function positionCarouselMenu(){var docWidth=jQuery(document).width();var containerWidth=jQuery('.container').width();var marginCarouselMenu=Math.round((docWidth-containerWidth)/2)-8;jQuery('.carousel-menu').css('margin-right',marginCarouselMenu);}
function onStateChange(event){switch(event.data){case YT.PlayerState.ENDED:jQuery.fancybox.close();break;}}};jQuery(window).load(function(){if(jQuery(".carousel").size()){scott.carousel.init();}});